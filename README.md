# README (Telegram Bot для регистрации времени Zuzex)

## Описание

Этот Telegram-бот предназначен для автоматической регистрации рабочего времени в Jira системе Zuzex через Tempo Timesheets. Бот поддерживает аутентификацию, запланированные напоминания и просмотр логов.

## Установка

1. Скопируйте `.env.example` в `.env`
2. Укажите `BOT_TOKEN`, `DATABASE_URL`, `ZUZEX_BASE_URL` и пр.
3. Создайте Docker-контейнер:
```bash
docker-compose up -d --build
```

## Структура данных

### Хранение данных:
- Бот хранит user_data (вкл. `salt`) в `PicklePersistence` (`bot_cache.pkl`)
- Данные пользователей (вкл. зашифрованные данные Jira) хранятся в базе PostgreSQL (ZuzexProfile)

### Шифрование:
- Аутентификационные ключи шифруются посредством менеджера [Crypt](utils/crypt/__init__.py) в обработчике [auth](commands/auth.py)
- Пользователь задает pin-code для расшифровки при вызове `/log`

## Доступные команды

### Общие:
- `/start` — стартовое сообщение
- `/who_am_i` — профиль пользователя
- `/time` — текущее время

### Профиль Jira:
- `/auth -u <login> -p <password> -t <task> -c <pin>` — добавить профиль
- `/log -c <pin>` — лог рабочего дня

### Напоминания:
- `/reminder -t <HH:MM> -r <true|false>` — установка напоминания
- `/clear` — очистка всех напоминаний

### Администраторские:
- `/op -p <password>` — стать админом
- `/users` — список пользователей
- `/logs -d <dd_mm_yyyy>` — логи за дату

## Запуск
```bash
python main.py
```

## Развёртывание
- При запуске бот регистрирует все команды и обработчики
- После старта производится восстановление напоминаний

## Автогенерация кода

Вспомогательные CLI-команды (см. `manage.py`):
- `gen-command <name>`
- `gen-model <name>`
- `gen-keyboard <name>`
- `sync-env-file`
- `send-secrets`

## Логирование
- Логи сохраняются в папке `/log`, отдельно по датам

---

По всем вопросам: [телеграм автора](https://t.me/apaem)

